
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Doing things</title>
	<meta name="author" content="khakimov">

	
	<meta name="description" content="Since monday I started playing with RubyOnRails and very happy that I
didn&#8217;t skip Ruby part as many beginers mistakenly do. I&#8217;m reading &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Doing things" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>

<body>
	<header id="header" class="inner"><h1><a href="/">Doing things</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:khakimov.github.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:khakimov.github.com">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner">


    <article class="post">
	<h1 class="title"><a href="/blog/2012/03/20/playing-with-hackernews/">Playing With HackerNews</a></h1>
	<div class="entry-content">
		<p>Since monday I started playing with RubyOnRails and very happy that I
didn&#8217;t skip Ruby part as many beginers mistakenly do. I&#8217;m reading <a href="http://pragprog.com/book/rails4/agile-web-development-with-rails">Agile Web Development with Rails</a> (big thanks to <a href="http://ap.thinkeffect.com">Andrija</a>) now and still have a lot of questions, but
today want to talk about other things.</p>

<p>As you know many books and tutorials show boring examples like &#8220;Hello Word&#8221; and my inflamed brain alwayls is looking for opportunity. To build, to parse or hack something. Today when I was waiting my turkey sandwitch in Palo Alto Cafe I read comment where is an author is talking about hackernews karma, like how is awesome to have large karma. I also checked his submissions and realised he just posted random stuff from techcrunch/gizmodo/mashable/etc. So, why not to try post new on HN with ruby?</p>

<p>I certainly do not intend to increase my karma with spam HN, but I was
interested to do it and going to share just few things about the
process.</p>

<h2>How to get fnid? </h2>

<p>To post something on HN you have to know fnid which generate everytime
when you GET <a href="http://news.ycombinator.com/submit">http://news.ycombinator.com/submit</a>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;nokogiri&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;open-uri&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">fetch</span>
</span><span class='line'>  <span class="n">submit_html</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;http://news.ycombinator.com/submit&#39;</span><span class="p">,</span> <span class="s2">&quot;Cookie&quot;</span> <span class="o">=&gt;</span>
</span><span class='line'><span class="s1">&#39;user=check_yours_cookie_and_put_here&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span>
</span><span class='line'>  <span class="n">doc</span> <span class="o">=</span> <span class="no">Nokogiri</span><span class="o">::</span><span class="no">HTML</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">submit_html</span><span class="p">)</span>
</span><span class='line'>  <span class="n">doc</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//form/input&#39;</span><span class="p">)</span><span class="o">[</span><span class="mi">0</span><span class="o">][</span><span class="s1">&#39;value&#39;</span><span class="o">]</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Posting</h2>

<p>Method fetch returns fnid. Ok, now we are going to submit our news with
method post:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s2">&quot;net/http&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
</span><span class='line'>  <span class="n">fnid</span> <span class="o">=</span> <span class="n">fetch</span> <span class="c1">#our fetch method</span>
</span><span class='line'>  <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fnid&#39;</span> <span class="o">=&gt;</span> <span class="n">fnid</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span> <span class="o">=&gt;</span> <span class="n">title</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span> <span class="o">=&gt;</span> <span class="n">url</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">uri</span> <span class="o">=</span> <span class="no">URI</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;http://news.ycombinator.com/r&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">http</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">uri</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">uri</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># the most interesting part. make headers with</span>
</span><span class='line'>  <span class="c1"># Cookie and Referer, also you can add User-Agent</span>
</span><span class='line'>  <span class="n">request</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">uri</span><span class="o">.</span><span class="n">request_uri</span><span class="p">)</span>
</span><span class='line'>  <span class="n">request</span><span class="o">.</span><span class="n">set_form_data</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span class='line'>  <span class="n">request</span><span class="o">[</span><span class="s2">&quot;Cookie&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s1">&#39;user=check_yours_cookie_and_put_here&#39;</span>
</span><span class='line'>  <span class="n">request</span><span class="o">[</span><span class="s2">&quot;Referer&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s1">&#39;http://news.ycombinator.com/submit&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Nice and simple, that&#8217;s why I fall in love with Ruby. Here is my
sandwich arrived ;)</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-03-20T21:56:00-07:00" pubdate data-updated="true">Mar 20<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/hackernews/'>hackernews</a>, <a class='category' href='/blog/categories/hacking/'>hacking</a>, <a class='category' href='/blog/categories/http/'>http</a>, <a class='category' href='/blog/categories/nokogiri/'>nokogiri</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/2012/03/16/put-off-procrastination/">Put Off Procrastination</a></h1>
	<div class="entry-content">
		<p>I&#8217;ve already written about idea with <a href="http://pupsor.github.com/blog/2012/03/07/next-idea-for-hacking-with-ruby/">blocker</a> and today I really tired of this and in hour wrote the script which allow you to block facebook, gmail, HN and so on with automatic changing statuses in Skype and Adium (DND).</p>

<p>The project called <a href="https://github.com/pupsor/freodom/">Freodom</a>.</p>

<blockquote><p>  Frēodōm is the Old English word for freedom; the state of being free and unconstrained.</p></blockquote>

<p><img src="http://i103.photobucket.com/albums/m151/KiJosh/procrastination.jpg" alt="put
off" /></p>

<ol>
<li>Frēodōm blocks:
  facebook.com,
  news.ycombinator.com,
  reddit.com,
  gmail.com,
  &#8230;</li>
<li>Automatically changes status to DND (skype/adium)</li>
</ol>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-03-16T22:07:00-07:00" pubdate data-updated="true">Mar 16<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/hacking/'>hacking</a>, <a class='category' href='/blog/categories/idea/'>idea</a>, <a class='category' href='/blog/categories/practice/'>practice</a>, <a class='category' href='/blog/categories/programming/'>programming</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/2012/03/15/tips-and-tricks/">Tips and Tricks</a></h1>
	<div class="entry-content">
		<p>Class methods are usually called with the double colon.</p>

<p>The respond_to? method is really nice and I plead that you never forget
it’s there. The respond_to? checks any object to be sure that it has a
certain method. It then gives back a true or false.</p>

<p>.collect keeps the answer the block gives back and adds it to a new
Array. The collect method is the perfect way of building a new Array
which is based on the items in an existing Array.</p>

<p>Always remember that a Module is only an inn. A roof over their heads.
It is not a self-aware Class and, therefore, cannot be brought to life
with new.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">SkatingContest</span>
</span><span class='line'>   <span class="k">def</span> <span class="nf">the_winner</span><span class="p">;</span> <span class="vi">@the_winner</span><span class="p">;</span> <span class="k">end</span>
</span><span class='line'>   <span class="k">def</span> <span class="nf">the_winner</span><span class="o">=</span><span class="p">(</span> <span class="nb">name</span> <span class="p">)</span>
</span><span class='line'>     <span class="k">unless</span> <span class="nb">name</span><span class="o">.</span><span class="n">respond_to?</span> <span class="ss">:to_str</span>
</span><span class='line'>       <span class="k">raise</span> <span class="no">ArgumentError</span><span class="p">,</span> <span class="s2">&quot;The winner&#39;s name must be a String,</span>
</span><span class='line'><span class="s2">         not a math problem or a list of names or any of that business.&quot;</span>
</span><span class='line'>     <span class="k">end</span>
</span><span class='line'>     <span class="vi">@the_winner</span> <span class="o">=</span> <span class="nb">name</span>
</span><span class='line'>   <span class="k">end</span>
</span><span class='line'> <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h1>Adding reference column:</h1>

<p>When you are modifying an existing table then references will not work. And actually, it is not really necessary when integer will work just as well.</p>

<p>I&#8217;d say the advantage of using references instead of a plain integer is that the model will be predefined with belongs_to and since the model is already created and will not be affected when you migrate something existing, the purpose is kind of lost.</p>

<p>So I would do like this instead:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">migration</span> <span class="n">add_user_id_to_tester</span> <span class="n">user_id</span><span class="ss">:integer</span>
</span></code></pre></td></tr></table></div></figure>


<p>And then manually add belongs_to :user in the Tester model</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-03-15T17:15:00-07:00" pubdate data-updated="true">Mar 15<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/rails/'>rails</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>, <a class='category' href='/blog/categories/tips/'>tips</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/2012/03/09/how-to-make-new-instagrams-friends-with-ruby/">How to Make New Instagram&#8217;s Friends With Ruby</a></h1>
	<div class="entry-content">
		<p>I moved to Palo Alto few month ago from LA and realized that I didn&#8217;t know anybody in Bay Area. I was looking for a new friends ;) I had one and his name is Ruby, so we decided to write some code which will help me to make new friends in instagram. First of all it was a good practice and also interesting task where you can easily get feedback from action (code and you get friends).</p>

<h2>Instagram</h2>

<p>It’s a fast, beautiful and fun way to share your life with friends through a series of pictures.</p>

<p>Snap a photo with your iPhone, choose a filter to transform the look and feel, send to Facebook, Twitter or Flickr – it’s all as easy as pie. It’s photo sharing, reinvented.</p>

<p>Instagram has <a href="http://instagram.com/developer/">API</a> which allows you to do anything you want - search users, their likes, relationships, comments, tags, locations and geo.</p>

<h2>Idea</h2>

<p>The idea was simple - to find by tags people who posted their photos from San Francisco and Bay Area (#sanfrancisco, #bayarea, #paloalto, #mountainview and so on). What will I get? I will get the users who probably living there and then I will just follow them and probably they will follow me back. So I will get followers from Bay Area and will able to talk through my pics with people who are living in Bay Area. As example, I can ask about some nice event or party and maybe somebody will share some or invite ;) Stupid isn&#8217;t? But it works!</p>

<h2>Code</h2>

<figure class='code'><figcaption><span>Let me introduce myself ;)</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;open-uri&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;uri&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;net/http&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;net/https&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;json&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="no">ACCESS_TOKEN</span> <span class="o">=</span> <span class="s2">&quot;put_yours_access_token_there&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">response</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">begin</span>
</span><span class='line'>    <span class="nb">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span><span class="o">.</span><span class="n">each_line</span> <span class="p">{</span><span class="o">|</span><span class="n">line</span><span class="o">|</span> <span class="n">response</span> <span class="o">+=</span> <span class="n">line</span> <span class="p">}</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span><span class='line'>  <span class="k">rescue</span> <span class="no">OpenURI</span><span class="o">::</span><span class="no">HTTPError</span>
</span><span class='line'>    <span class="kp">nil</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">get_followers</span>
</span><span class='line'>  <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://api.instagram.com/v1/users/self/followed-by?access_token=</span><span class="si">#{</span><span class="no">ACCESS_TOKEN</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="n">next_url</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">[</span><span class="s1">&#39;pagination&#39;</span><span class="o">][</span><span class="s1">&#39;next_url&#39;</span><span class="o">]</span>
</span><span class='line'>  <span class="n">followers</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">while</span> <span class="n">next_url</span>
</span><span class='line'>    <span class="n">result</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">(</span><span class="n">next_url</span><span class="p">)</span>
</span><span class='line'>    <span class="n">next_url</span> <span class="o">=</span> <span class="n">result</span><span class="o">[</span><span class="s1">&#39;pagination&#39;</span><span class="o">][</span><span class="s1">&#39;next_url&#39;</span><span class="o">]</span>
</span><span class='line'>    <span class="n">result</span><span class="o">[</span><span class="s1">&#39;data&#39;</span><span class="o">].</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">data</span><span class="o">|</span> <span class="n">followers</span><span class="o">.</span><span class="n">merge!</span><span class="p">(</span><span class="n">data</span><span class="o">[</span><span class="s1">&#39;username&#39;</span><span class="o">]</span> <span class="o">=&gt;</span> <span class="n">data</span><span class="o">[</span><span class="s1">&#39;id&#39;</span><span class="o">]</span><span class="p">)}</span>
</span><span class='line'>    <span class="nb">p</span> <span class="n">followers</span><span class="o">.</span><span class="n">count</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">followers</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">unfollow_mutual_friends</span><span class="p">(</span><span class="n">followers</span><span class="p">)</span>
</span><span class='line'>  <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://api.instagram.com/v1/users/self/follows?access_token=</span><span class="si">#{</span><span class="no">ACCESS_TOKEN</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="n">next_url</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">[</span><span class="s1">&#39;pagination&#39;</span><span class="o">][</span><span class="s1">&#39;next_url&#39;</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">while</span> <span class="n">next_url</span>
</span><span class='line'>    <span class="n">result</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">(</span><span class="n">next_url</span><span class="p">)</span>
</span><span class='line'>    <span class="n">next_url</span> <span class="o">=</span> <span class="n">result</span><span class="o">[</span><span class="s1">&#39;pagination&#39;</span><span class="o">][</span><span class="s1">&#39;next_url&#39;</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">result</span><span class="o">[</span><span class="s1">&#39;data&#39;</span><span class="o">].</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">data</span><span class="o">|</span>
</span><span class='line'>      <span class="k">unless</span> <span class="n">followers</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="n">data</span><span class="o">[</span><span class="s1">&#39;username&#39;</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>        <span class="n">uri</span> <span class="o">=</span> <span class="no">URI</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;https://api.instagram.com/v1/users/</span><span class="si">#{</span><span class="n">data</span><span class="o">[</span><span class="s1">&#39;id&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">/relationship?access_token=</span><span class="si">#{</span><span class="no">ACCESS_TOKEN</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="n">http</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">uri</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">uri</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>
</span><span class='line'>        <span class="n">http</span><span class="o">.</span><span class="n">use_ssl</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>        <span class="n">http</span><span class="o">.</span><span class="n">verify_mode</span> <span class="o">=</span> <span class="no">OpenSSL</span><span class="o">::</span><span class="no">SSL</span><span class="o">::</span><span class="no">VERIFY_NONE</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">request</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">uri</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</span><span class='line'>        <span class="n">request</span><span class="o">.</span><span class="n">set_form_data</span><span class="p">(</span><span class="s2">&quot;action&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;unfollow&quot;</span><span class="p">,</span> <span class="s2">&quot;access_token&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">ACCESS_TOKEN</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</span><span class='line'>        <span class="nb">p</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">data</span><span class="o">[</span><span class="s1">&#39;username&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2"> code </span><span class="si">#{</span><span class="n">response</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">find_users_by_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
</span><span class='line'>  <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://api.instagram.com/v1/tags/</span><span class="si">#{</span><span class="n">tag</span><span class="si">}</span><span class="s2">/media/recent?access_token=</span><span class="si">#{</span><span class="no">ACCESS_TOKEN</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="n">next_url</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">[</span><span class="s1">&#39;pagination&#39;</span><span class="o">][</span><span class="s1">&#39;next_url&#39;</span><span class="o">]</span>
</span><span class='line'>  <span class="n">users</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">while</span> <span class="n">next_url</span>
</span><span class='line'>    <span class="n">result</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">(</span><span class="n">next_url</span><span class="p">)</span>
</span><span class='line'>    <span class="n">next_url</span> <span class="o">=</span> <span class="n">result</span><span class="o">[</span><span class="s1">&#39;pagination&#39;</span><span class="o">][</span><span class="s1">&#39;next_url&#39;</span><span class="o">]</span>
</span><span class='line'>    <span class="n">result</span><span class="o">[</span><span class="s1">&#39;data&#39;</span><span class="o">].</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">data</span><span class="o">|</span> <span class="n">users</span><span class="o">.</span><span class="n">merge!</span><span class="p">(</span><span class="n">data</span><span class="o">[</span><span class="s1">&#39;user&#39;</span><span class="o">][</span><span class="s1">&#39;username&#39;</span><span class="o">]</span> <span class="o">=&gt;</span> <span class="n">data</span><span class="o">[</span><span class="s1">&#39;user&#39;</span><span class="o">][</span><span class="s1">&#39;id&#39;</span><span class="o">]</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>    <span class="c1"># people who likes pics with this tag</span>
</span><span class='line'>    <span class="c1">#data[&#39;likes&#39;][&#39;data&#39;].each { |likes| @users.merge!(likes[&#39;username&#39;] =&gt; likes[&#39;id&#39;]) } </span>
</span><span class='line'>    <span class="nb">p</span> <span class="n">users</span><span class="o">.</span><span class="n">count</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">follow_users</span><span class="p">(</span><span class="n">potential_friends</span><span class="p">)</span>
</span><span class='line'>  <span class="n">potential_friends</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">username</span><span class="p">,</span> <span class="nb">id</span><span class="o">|</span>
</span><span class='line'>    <span class="n">uri</span> <span class="o">=</span> <span class="no">URI</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;https://api.instagram.com/v1/users/</span><span class="si">#{</span><span class="nb">id</span><span class="si">}</span><span class="s2">/relationship?access_token=</span><span class="si">#{</span><span class="no">ACCESS_TOKEN</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">http</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">uri</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">uri</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>
</span><span class='line'>    <span class="n">http</span><span class="o">.</span><span class="n">use_ssl</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>    <span class="n">http</span><span class="o">.</span><span class="n">verify_mode</span> <span class="o">=</span> <span class="no">OpenSSL</span><span class="o">::</span><span class="no">SSL</span><span class="o">::</span><span class="no">VERIFY_NONE</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">request</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">uri</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</span><span class='line'>    <span class="n">request</span><span class="o">.</span><span class="n">set_form_data</span><span class="p">(</span><span class="s2">&quot;action&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;follow&quot;</span><span class="p">,</span> <span class="s2">&quot;access_token&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">ACCESS_TOKEN</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">username</span><span class="si">}</span><span class="s2"> added&quot;</span> <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="s2">&quot;200&quot;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>So, if we want to find and follow people who tagged their pics with tag #paloalto:</p>

<figure class='code'><figcaption><span>find users by tag #paloalto and follow them</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">potential_friends</span> <span class="o">=</span> <span class="n">find_users_by_tag</span><span class="p">(</span><span class="s2">&quot;paloalto&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">follow_user</span><span class="p">(</span><span class="n">potential_friends</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>To unfollow people we have to know who is following us and then unfollow who is not.</p>

<figure class='code'><figcaption><span>unfollow !mutual people</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">followers</span> <span class="o">=</span> <span class="n">get_followers</span>
</span><span class='line'><span class="n">unfollow_mutual_friends</span><span class="p">(</span><span class="n">followers</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>so, that&#8217;s it. Of course this is my ugly code has to be improved and will be better to add some features like save followers list, save position of finding user by tag (disconnect or something - save the last url and next run will be continue parsing from this position). Anyway, this is just simple ruby script (heh, I&#8217;ve rewritten few time, it was good practice but still code look ugly I know).</p>

<p>ps: proof
<img src="http://pix.am/HIiH.png" alt="proof" /></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-03-09T11:09:00-08:00" pubdate data-updated="true">Mar 9<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/hacking/'>hacking</a>, <a class='category' href='/blog/categories/instagram/'>instagram</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/2012/03/07/c-style-shorthand-conditional-operator/">C-style Shorthand Conditional Operator ?</a></h1>
	<div class="entry-content">
		<figure class='code'><figcaption><span>C-style shorthand conditional operator</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="mi">1</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">?</span> <span class="s2">&quot;true value&quot;</span> <span class="p">:</span> <span class="s2">&quot;false value&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Returns &#8220;false value&#8221;</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-03-07T19:15:00-08:00" pubdate data-updated="true">Mar 7<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/ruby-/'>ruby,</a>, <a class='category' href='/blog/categories/tips/'>tips</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/2012/03/07/next-idea-for-hacking-with-ruby/">Next Idea for Hacking With Ruby</a></h1>
	<div class="entry-content">
		<p>Right now I&#8217;m sitting at public library of Palo Alto because I have reason. This reason is based on my laziness and totally destructions by anything around me, probably correct word which can describe my problem is procrastination, you can read about  <a href="http://youarenotsosmart.com/2010/10/27/procrastination/">Proctastionation here</a>.</p>

<blockquote><p>  Procrastination is an impulse; it’s buying candy at the checkout. Procrastination is also hyperbolic discounting, taking the sure thing in the present over the caliginous prospect some day far away.</p></blockquote>

<p>So, now you can understand why am I sitting in public library, because this is only one place where I can easily focus and concentrate for doing things or learn to code. Only here I never think about one more cup o tea/coffee or lying to the sofa and think about thinking. But still one bad thing happened here and this thing (I&#8217;ve never thought what I&#8217;ll able to say this) is internet, to be honest I&#8217;m talking about &#8220;bad&#8221; side of internet like any kind of social networks, AIM, Skype and email.</p>

<p>As you can see those things are our impulse with fast feedback; it&#8217;s buying candy at the checkout or checking facebook&#8217;s page, email, twitter, response on each message in Skype and Jabber. To finish my long entry I want to be disconnected for the time when I want to concentrate and focus on current task. But how? Even public library has wi-fi spot. To solve this problem I should disconect myself from the internet or filter it without any &#8220;easy&#8221; turn off solution, if I want to disconnect for 1 hour - I will and nothing can unblock it except reboot.</p>

<p><img src="http://thejesuswave.files.wordpress.com/2009/03/concentration.gif" alt="Concentrate with Ruby" /></p>

<p>I&#8217;ve seen few apps with same idea, like <a href="http://macfreedom.com/">Freedom</a> that disconect network for a certain time (like have a freedom for 1 hour or 2 hours ;). It costs $10 and works well, but I want to count how many hours I was disconected, maybe try to count how many requests I did to facebook, twitter and how addicted am I and so on.</p>

<p>Few ideas how to do it on mac:</p>

<blockquote><ul>
<li> /etc/hosts</li>
<li> ipfw</li>
<li> just shutdown network interface</li>
</ul>
</blockquote>

<p>to be continue&#8230;</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-03-07T13:54:00-08:00" pubdate data-updated="true">Mar 7<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/hacking/'>hacking</a>, <a class='category' href='/blog/categories/idea/'>idea</a>, <a class='category' href='/blog/categories/practice/'>practice</a>, <a class='category' href='/blog/categories/programming/'>programming</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/2012/03/04/cli-alternative-to-delicious-for-saving-links/">CLI Alternative to Delicious for Saving Links</a></h1>
	<div class="entry-content">
		<p>Month ago my friend asked me if I want to learn to code
he will help me to <a href="http://artemyankov.com/post/7112169965/essentials-to-learn-ruby-from-zero-to-advanced">learn Ruby from scratch</a>.
That was good idea and now I&#8217;m going through the list and today finished Elegient Ruby by Russ Olsen
what was really good book. As you know nothing better than practice and
I&#8217;ve started doing some simple stuff and to motivate myself I&#8217;m working
on some interesting small project to automation and simplification my
daily tasks and few days ago I did Droplicious.</p>

<p><img src="https://a248.e.akamai.net/assets.github.com/img/e8e0ee1f3c0182f3081890076752ae1ebd02e97d/687474703a2f2f7069782e616d2f7a3279542e706e67" alt="bookmarks in you
terminal" /></p>

<p><a href="https://github.com/pupsor/droplicious">Droplicious</a> is Delicious (bookmark app) at you terminal with syncronization function between your&#8217;s boxes via dropbox. This is my first project with Ruby, so, code looks pretty ugly.
Now it has only few features (and probably it is enough):</p>

<blockquote><ul>
<li>add link with desc and tags</li>
<li>search by tag</li>
<li>open link in current browser</li>
<li>dropbox does sync job ;)</li>
</ul>
</blockquote>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-03-04T22:29:00-08:00" pubdate data-updated="true">Mar 4<span>th</span>, 2012</time></div>
	<div class="tags">

</div>
	
</div></article>

<nav id="pagenavi">
    
        <a href="/blog/page/2/" class="prev">Prev</a>
    
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2012

    khakimov

</footer>
	<script src="/javascripts/slash.js"></script>
<script type="text/javascript">
var _hcp = _hcp || {};
_hcp.widget_id = 2313;
_hcp.widget = "Stream";
(function() { 
var hcc = document.createElement("script"); hcc.type = "text/javascript"; hcc.async = true;
hcc.src = ("https:" == document.location.protocol ? "https" : "http")+"://widget.hypercomments.com/apps/js/hc.js";
var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hcc, s.nextSibling); 
})();</script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->




	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-31552911-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>