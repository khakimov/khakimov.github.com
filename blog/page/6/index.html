
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>curious and driven</title>
	<meta name="author" content="khakimov">

	
	<meta name="description" content="I&#8217;m actively hacking away in a lab environment, preparing for the Offensive Security Certified Professional (OSCP) exam. Jan 6th, 2013 offsec &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="curious and driven" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>

<body>
	<header id="header" class="inner"><h1><a href="/">curious and driven</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:khakimov.github.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:khakimov.github.com">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner">


    <article class="post">
	<h1 class="title"><a href="/blog/2013/01/06/offensive-security-certified-professional/">Offensive Security Certified Professional</a></h1>
	<div class="entry-content">
		<p> I&#8217;m actively hacking away in a lab environment, preparing for the Offensive Security Certified Professional (OSCP) exam.</p>

<p> <img src="http://i.imgur.com/obg2H.gif" alt="" /></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-01-06T15:34:00-08:00" pubdate data-updated="true">Jan 6<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/offsec/'>offsec</a>, <a class='category' href='/blog/categories/security/'>security</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/2012/12/23/automatically-rewrite-http-to-https-with-js/">Automatically Rewrite HTTP to HTTPS With JS</a></h1>
	<div class="entry-content">
		<p>I wrote the post <a href="http://khakimov.com/blog/2012/11/24/what-is-wrong-with-http-secure/">What Is Wrong With HTTP Secure</a> and my friend gave me an idea to try just rewrite hardcoded link (http:// -> https://). The beauty of JS are simplicity, documentations and tons of examples, so even if you don&#8217;t know how to get element without using jQuery it will be easy to figure out in couple minutes as I did in the night.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span> <span class="o">===</span> <span class="s1">&#39;https:&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// http to https for &lt;link&gt;</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">links</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">links</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">href</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;http:&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">link</span> <span class="o">=</span> <span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">href</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;http:&#39;</span><span class="p">,</span> <span class="s1">&#39;https:&#39;</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">link</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// http to https for &lt;script&gt;</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">scripts</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">scripts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="nx">scripts</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">src</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;http:&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">script</span> <span class="o">=</span> <span class="nx">scripts</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">src</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;http:&#39;</span><span class="p">,</span> <span class="s1">&#39;https:&#39;</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">scripts</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">script</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// http to https for images</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">images</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">images</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="nx">images</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">src</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;http:&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">img</span> <span class="o">=</span> <span class="nx">images</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">src</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;http:&#39;</span><span class="p">,</span> <span class="s1">&#39;https:&#39;</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">images</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">img</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Maybe folks from KBIT.dk will add it to their chrome extensions <a href="https://code.google.com/p/kbsslenforcer/">KB SSL Enforcer</a>. Anyway, my Internet looks much better now =) and safer!</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-12-23T11:15:00-08:00" pubdate data-updated="true">Dec 23<span>rd</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/https/'>https</a>, <a class='category' href='/blog/categories/js/'>js</a>, <a class='category' href='/blog/categories/security/'>security</a>, <a class='category' href='/blog/categories/ssl/'>ssl</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/2012/12/10/english-shellcode/">English Shellcode</a></h1>
	<div class="entry-content">
		<p>This paper demonstrate a technique for automatically producing English Shellcode — that is, transforming arbitrary shellcode into a representation that is statistically similar to English prose.</p>

<p><img src="http://pix.am/kWJT.png" alt="" /></p>

<p><a title="View Ccs243 Mason on Scribd" href="http://www.scribd.com/doc/116712351/Ccs243-Mason" style="margin: 12px auto 6px auto; font-family: Helvetica,Arial,Sans-serif; font-style: normal; font-variant: normal; font-weight: normal; font-size: 14px; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none; display: block; text-decoration: underline;">Ccs243 Mason</a><iframe class="scribd_iframe_embed" src="http://www.scribd.com/embeds/116712351/content?start_page=1&view_mode=scroll&access_key=key-kfmhab4cfcscgy1dh9i" data-auto-height="false" data-aspect-ratio="0.772727272727273" scrolling="no" id="doc_18420" width="100%" height="600" frameborder="0"></iframe></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-12-10T21:56:00-08:00" pubdate data-updated="true">Dec 10<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/security/'>security</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/2012/12/09/bypassing-dep-slash-aslr-protections/">Bypassing DEP/ASLR Protections</a></h1>
	<div class="entry-content">
		<p>Today we are going to learn about data execution prevention (DEP) and address space layout randomization (ASLR). Last Sunday I read about <a href="http://khakimov.com/blog/2012/12/02/return-into-libc-without-function-calls/">return-into-libc</a> and one week before was post about <a href="http://khakimov.com/blog/2012/11/20/buffer-overflow/">buffer overflow</a> as-is. Both methods reqired to know the address of attacker shellcode and/or standard kernel library (we found out the address of system() function in the memory to use it in <strong>return-into-libc</strong> with this code int main() { system();}). Modern systems decided to implement something what will make stack addresses and addressess of library routines unpredictable and different from machine to machine (no more universal exploits =) kidding).</p>

<p>Author <a href="https://twitter.com/justdionysus">Dionysus Blazakis</a> holds BS from University of Maryland and doing interesting things, I saw his presentation &#8220;The Apple Sandbox&#8221; and then found this paper, great job Dionysus. I inspired by his example and it motivates me to keep digging in research field. Dion, if you&#8217;ll ever read this I just want to say thank you! Lets get back to his paper and read what this smart fellow prepared for us.</p>

<p><a title="View Blazakis on Scribd" href="http://www.scribd.com/doc/116197211/Blazakis" style="margin: 12px auto 6px auto; font-family: Helvetica,Arial,Sans-serif; font-style: normal; font-variant: normal; font-weight: normal; font-size: 14px; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none; display: block; text-decoration: underline;">Blazakis</a><iframe class="scribd_iframe_embed" src="http://www.scribd.com/embeds/116197211/content?start_page=1&view_mode=scroll&access_key=key-1dr5xy06ojvmp97eq1hg" data-auto-height="false" data-aspect-ratio="0.772727272727273" scrolling="no" id="doc_39852" width="100%" height="600" frameborder="0"></iframe></p>

<p>DEP and ASLR are very real problem in the side of an exploit developer. DEP makes locating shellcode difficult, ASLR further complicates an attack by obfuscating the base address of the loaded data. Adobe Flash Player is used as an example, Dion also referenced to JIT spraying (Just-In-Time).</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>A Just-in-time compiler (JIT), by definition, produces machine 
</span><span class='line'>code as its output. Since it produces executable data, a JIT 
</span><span class='line'>compiler is one of the few types of programs that **cannot** be 
</span><span class='line'>run in a **no-executable-data environment**. Therefore, JIT 
</span><span class='line'>compilers are normally exempt from data execution prevention. A 
</span><span class='line'>JIT spray compiles code that then proceeds to spray the memory 
</span><span class='line'>with enough instances of exploit code to overwhelm the address 
</span><span class='line'>space randomization and execute the exploit itself.</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>JIT spraying is very simular to heap spraying, in simple terms attacker stuff heap with multiple copies of attack code (payload) and that increases the chances of successful exploitation.</p>

<p>JIT Spray Exploit Demo</p>

<iframe width="640" height="480" src="http://www.youtube.com/embed/HJuBpciJ3Ao?rel=0" frameborder="0" allowfullscreen></iframe>


<p>So, why do you need this? If you found the overflow in the modern browsers you will not able to use it easily, because of randomization, the address space is randomized and you don&#8217;t know where to point EIP and even if you have data in the heap DEP wont allow you to execute it. But you can use Just-In-Time compiler which will allocate writable memory for you and write executable code into it. For more details please read the paper above. Enjoy!</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-12-09T21:13:00-08:00" pubdate data-updated="true">Dec 9<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/computer-security/'>computer security</a>, <a class='category' href='/blog/categories/great-papers/'>great papers</a>, <a class='category' href='/blog/categories/research/'>research</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/2012/12/05/you-and-your-research/">You and Your Research</a></h1>
	<div class="entry-content">
		<iframe width="853" height="480" src="http://www.youtube.com/embed/JoVx_-bM8Tg?rel=0" frameborder="0" allowfullscreen></iframe>


<p><a href="https://conference.hitb.org/hitbsecconf2012kul/materials/D1T2%20-%20Haroon%20Meer%20-%20You%20and%20Your%20Research.pdf">PDF</a></p>

<p>What does it take to do quality research? What stops you from being a one-hit wonder? Is there an age limit to productive hackery? What are the key ingredients needed and how can you up your chances of doing great work? In a talk unabashedly stolen from far greater minds we hope to answer these questions and discuss their repercussions.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-12-05T16:43:00-08:00" pubdate data-updated="true">Dec 5<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/-hitb2012kul/'>#HITB2012KUL</a>, <a class='category' href='/blog/categories/motivation/'>motivation</a>, <a class='category' href='/blog/categories/research/'>research</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/2012/12/02/return-into-libc-without-function-calls/">Return-into-libc Without Function Calls</a></h1>
	<div class="entry-content">
		<p>Since OpenBSD has a nonexecutable stack by default and you can also patch your Linux kernel and make nonexecutable stack through PaX, AMD and Intel recently added to their processors a per-page execute disable bit to ease WOX implementation and even Microsoft implement WOX (no location in memory into which the attacker can inject code to execute, or just imagine no memory location in a process image is marked both writable - W and executable - X) all it means you can not execute your shellcode on the stack.</p>

<p>Today I read about technique is known as <strong>return into libc</strong> by <a href="http://cseweb.ucsd.edu/~hovav/">Hovav Shacham</a> (btw, his Ph.D. advisor was professor of Computer Science and Electrial Engineering at Stanford <a href="http://crypto.stanford.edu/~dabo/">Dan Boneh</a>. I took his CS155 class, he is really good in his field).</p>

<p>What is this about? If we can&#8217;t write in stack what should we do? We can&#8217;t inject code, so, we will use code that already exists in the proccess image we are attacking. <strong>Libc</strong> is the usual target that contains various basic functions, such as printf() and exit(). These functions are share, so any program that uses the printf() function directs execution into the appropriate location in libc. And attacker with his explout can do the same thing and direct a program&#8217;s execution into a certain function in libc. But in principle any available code, either from the program&#8217;s text segment of from a library it links to, could be used instead libc.</p>

<p>Enjoy!</p>

<p><a title="View Geometry (1) on Scribd" href="http://www.scribd.com/doc/115228599/Geometry-1" style="margin: 12px auto 6px auto; font-family: Helvetica,Arial,Sans-serif; font-style: normal; font-variant: normal; font-weight: normal; font-size: 14px; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none; display: block; text-decoration: underline;">Geometry (1)</a><iframe class="scribd_iframe_embed" src="http://www.scribd.com/embeds/115228599/content?start_page=1&view_mode=scroll&access_key=key-1qjla86da9zi8xelaiqr" data-auto-height="false" data-aspect-ratio="0.772727272727273" scrolling="no" id="doc_22341" width="100%" height="600" frameborder="0"></iframe></p>

<p>I played a litle bit with <strong>return into libc</strong> and the main idea was to force the program to spawn a shell without executing anything on the stack, by returning int the libc function system().</p>

<figure class='code'><figcaption><span>sys.c</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>   <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
</span><span class='line'>   <span class="n">strcpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span><span class='line'>   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>tmp.c</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span> <span class="n">system</span><span class="p">();</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>tmp.c</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">rus</span><span class="err">@</span><span class="n">rus</span><span class="o">-</span><span class="n">desktop</span><span class="o">:/</span><span class="n">tmp</span> <span class="err">$</span> <span class="n">gcc</span> <span class="o">-</span><span class="n">o</span> <span class="n">t</span> <span class="n">tmp</span><span class="p">.</span><span class="n">c</span>
</span><span class='line'><span class="n">rus</span><span class="err">@</span><span class="n">rus</span><span class="o">-</span><span class="n">desktop</span><span class="o">:/</span><span class="n">tmp</span> <span class="err">$</span> <span class="n">gdb</span> <span class="o">-</span><span class="n">q</span> <span class="p">.</span><span class="o">/</span><span class="n">t</span>
</span><span class='line'><span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">break</span> <span class="n">main</span>
</span><span class='line'><span class="n">Breakpoint</span> <span class="mi">1</span> <span class="n">at</span> <span class="mh">0x804837a</span>
</span><span class='line'><span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">run</span>
</span><span class='line'><span class="n">Starting</span> <span class="n">program</span><span class="o">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">t</span>
</span><span class='line'>
</span><span class='line'><span class="n">Breakpoint</span> <span class="mi">1</span><span class="p">,</span> <span class="mh">0x0804837a</span> <span class="n">in</span> <span class="n">main</span> <span class="p">()</span>
</span><span class='line'><span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">print</span> <span class="n">system</span>
</span><span class='line'><span class="err">$</span><span class="mi">1</span> <span class="o">=</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">text</span> <span class="n">variable</span><span class="p">,</span> <span class="n">no</span> <span class="n">debug</span> <span class="n">info</span><span class="o">&gt;</span><span class="p">}</span> <span class="mh">0xb7ed0d80</span> <span class="o">&lt;</span><span class="n">system</span><span class="o">&gt;</span>
</span><span class='line'><span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">quit</span>
</span></code></pre></td></tr></table></div></figure>


<p>here we got address of function <strong>system()</strong> and it is located at <strong>0xb7ed0d80</strong>.</p>

<figure class='code'><figcaption><span>tmp.c</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">rus</span><span class="err">@</span><span class="n">rus</span><span class="o">-</span><span class="n">desktop</span><span class="o">:/</span><span class="n">tmp</span> <span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="n">out</span> <span class="err">$</span><span class="p">(</span><span class="n">perl</span> <span class="o">-</span><span class="n">e</span> <span class="err">&#39;</span><span class="n">print</span> <span class="s">&quot;AAAA&quot;</span><span class="n">x7</span> <span class="p">.</span> <span class="s">&quot;</span><span class="se">\x80\x0d\xed\xb7</span><span class="s">&quot;</span><span class="err">&#39;</span><span class="p">)</span>
</span><span class='line'><span class="nl">sh:</span> <span class="o">????????:</span> <span class="n">command</span> <span class="n">not</span> <span class="n">found</span>
</span><span class='line'><span class="n">Segmentation</span> <span class="n">fault</span>
</span></code></pre></td></tr></table></div></figure>


<p>7 words of data are used for spacin in the exploit and then we call system() as you can see. In this example I don&#8217;t pass any arguments, but it&#8217;s should be of course &#8220;/bin/sh&#8221;. That&#8217;s my Sunday and happy hacking hours!</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-12-02T14:12:00-08:00" pubdate data-updated="true">Dec 2<span>nd</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/computer-security/'>computer security</a>, <a class='category' href='/blog/categories/great-papers/'>great papers</a>, <a class='category' href='/blog/categories/research/'>research</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/2012/11/24/what-is-wrong-with-http-secure/">What Is Wrong With HTTP Secure</a></h1>
	<div class="entry-content">
		<p>That&#8217;s not a secret that I in love with security and I&#8217;m using some applications on a regular basis to protect my security such as vpn when using public wifi or https everythere where it is possible. HTTPS is not a holy Grail, but often https is enough to secure facebook or gmail connection. Of course I know about DNS changer/spoof or force HTTP session insted HTTPS which attackers use often and that&#8217;s why I&#8217;m using also <strong><a href="https://chrome.google.com/webstore/detail/kb-ssl-enforcer/flcpelgcagfhfoegekianiofphddckof/details">KB SSL Enforcer</a></strong>.</p>

<p>KB SSL Enforcer helps automatically detects if a site supports SSL and redirects you to it. Also it blocks insecure content when you load page over ssl and something on this page has insecure css/js/image.</p>

<p>Security can be compromised completely by an active atacker exploiting a simple mistake such as loading css, image or Flash banner over an insecure connection. For instance,</p>

<p><a href="https://nytimes.com">nytimes.com</a>
<img src="http://pix.am/L0CO.png" alt="" /></p>

<p><a href="https://woot.com">woot.com</a>:
<img src="http://pix.am/GPYh.png" alt="" /></p>

<p><a href="https://www.dailymotion.com/us">dailymotion.com</a>
<img src="http://pix.am/kY88.png" alt="" /></p>

<p><a href="https://www.ehow.com/">ehow.com</a>
<img src="http://pix.am/bFrO.png" alt="" /></p>

<p>so on and so on&#8230; Problem is very simple - <strong>hardcoded http://</strong> links.</p>

<p><strong>Solution?</strong> Please, don&#8217;t use hardcoded http:// if you have http and https! I hope having https version is going to be as a standard and this is really good news &#8221;<a href="https://tools.ietf.org/html/rfc6797">HTTP Strict Transport Security (HSTS)</a>&#8221;. This RFC was approved couple days ago, read it and don&#8217;t forget to check your website!</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-11-24T12:33:00-08:00" pubdate data-updated="true">Nov 24<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/https/'>https</a>, <a class='category' href='/blog/categories/security/'>security</a>, <a class='category' href='/blog/categories/ssl/'>ssl</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/2012/11/24/hero-lecture-dr-vint-cerf/">Hero Lecture: Dr. Vint Cerf</a></h1>
	<div class="entry-content">
		<iframe width="640" height="480" src="http://www.youtube.com/embed/v7Lai2lkKnM?rel=0" frameborder="0" allowfullscreen></iframe>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-11-24T00:01:00-08:00" pubdate data-updated="true">Nov 24<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/hero/'>hero</a>, <a class='category' href='/blog/categories/legend/'>legend</a>, <a class='category' href='/blog/categories/stanford/'>stanford</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/2012/11/20/buffer-overflow/">Buffer Overflow</a></h1>
	<div class="entry-content">
		<p>I&#8217;m very interesting in research paper and want to know better what computer security research is like. I found Vitaly Shmatikov and his course about great papers in Computer Security and decided to try each weekend read and write about one paper.</p>

<p>Vitaly Shmatikov is one of most interesting person for me in computer security and privacy. He got his PhD at Stanford and his thesis was &#8221;<a href="https://www.cs.utexas.edu/~shmat/shmat_tcs.pdf">Finite-State Analysis of Security Protocols</a>&#8221;, also his prof at Stanford was John C. Mitchell.</p>

<p>So, today I want to start with Buffer Overflow and here is paper 1999 by Crispin Cowan, Perry Wagle, Calton Pu,Steve Beattie, and Jonathan Walpole.</p>

<p><a title="View Overflow on Scribd" href="http://www.scribd.com/doc/113583111/Overflow" style="margin: 12px auto 6px auto; font-family: Helvetica,Arial,Sans-serif; font-style: normal; font-variant: normal; font-weight: normal; font-size: 14px; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none; display: block; text-decoration: underline;">Overflow</a><iframe class="scribd_iframe_embed" src="http://www.scribd.com/embeds/113583111/content?start_page=1&view_mode=scroll&access_key=key-39aierbs22vhrn0azpl" data-auto-height="true" data-aspect-ratio="0.772727272727273" scrolling="no" id="doc_1657" width="100%" height="600" frameborder="0"></iframe></p>

<p>Btw, in this paper they metioned about Morris Worm and early versions of using buffer overflow and I found the peace of Morris Worm&#8217;s overflow:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>; VAX binary code fragment from the Morris Internet Worm.
</span><span class='line'>; Downloaded to the fingerd serving process via the gets() hole.
</span><span class='line'>; Performs execve(“/bin/sh”,0,0)
</span><span class='line'>pushl $0068732f   ; last half of name: "/sh\0"
</span><span class='line'>pushl $6e69622f   ; first half of name: "/bin"
</span><span class='line'>mov   sp,r10            ; pointer to the string
</span><span class='line'>pushl $0          ; 3rd parameter: environment = null
</span><span class='line'>pushl $0          ; 2nd parameter: args = null
</span><span class='line'>pushl r10         ; 1st parameter: pointer to the executable name
</span><span class='line'>pushl $3          ; 3 parameters on the stack
</span><span class='line'>movl  sp,ap       ; ArgumentPointer points to arguments
</span><span class='line'>chmk  $3b         ; SoftwareException 0x3B = EXECVE call</span></code></pre></td></tr></table></div></figure>


<p>It used a buffer overflow against the fingerd daemon. Other worms also often use buffer overflow to compromise the machine. CodeRed used overflow in MS-IIS server, SQL Slammer - overflow in MSSQL server, Sasser overflow in Windows LSASS, Conficker used overflow in Windows RPC and famous Stuxnet used several 0day overflows and same Windows RPC as Conficker. Looks like Buffer Overflow is the basis of many software vulnerabilities and can be maliciously exploited.</p>

<p>In computer security and programming, a buffer overflow, or buffer overrun, is an anomaly where a program, while writing data to a buffer, overruns the buffer&#8217;s boundary and overwrites adjacent memory. <strong>Buffer</strong> is a data storage area inside computer memory (stack or heap).</p>

<p>Suppose we have Webserver contain this function</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="kt">void</span> <span class="nf">f</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>    <span class="c1">// allocate 100 bytes on stack </span>
</span><span class='line'>      <span class="n">strcpy</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>   <span class="c1">// copy argument into local buffer</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>strcpy</strong> does not check whether the string at *s contains fewer than 126 characters and if a string longer than 126 bytes is copied into buffer, it will overwrite adjacent stack locations.</p>

<p><img src="http://pix.am/ou9H.png" alt="" />
<img src="http://pix.am/HSH8.png" alt="" /></p>

<p>We overflow the return address and set address of attack code (the value in the RET position must point to the beginning of attack assembly code in the buffer, otherwise application will crash with segmentation violation).</p>

<p>Other exampe from <strong>Hacking</strong> book</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;string.h&gt;</span>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>   <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span><span class='line'>   <span class="kt">char</span> <span class="n">buffer_one</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">buffer_two</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>   <span class="n">strcpy</span><span class="p">(</span><span class="n">buffer_one</span><span class="p">,</span> <span class="s">&quot;one&quot;</span><span class="p">);</span>
</span><span class='line'>   <span class="n">strcpy</span><span class="p">(</span><span class="n">buffer_two</span><span class="p">,</span> <span class="s">&quot;two&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>   <span class="n">printf</span><span class="p">(</span><span class="s">&quot;[BEFORE] buffer_two is at %p contain </span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">buffer_two</span><span class="p">,</span> <span class="n">buffer_two</span><span class="p">);</span>
</span><span class='line'>   <span class="n">printf</span><span class="p">(</span><span class="s">&quot;[BEFORE] buffer_one is at %p contain </span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">buffer_one</span><span class="p">,</span> <span class="n">buffer_one</span><span class="p">);</span>
</span><span class='line'>   <span class="n">printf</span><span class="p">(</span><span class="s">&quot;[BEFORE] value is at %p and is %d (0x%08x)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>   <span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">[STRCPY] copying %d bytes into buffer_two</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">strlen</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
</span><span class='line'>   <span class="n">strcpy</span><span class="p">(</span><span class="n">buffer_two</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span><span class='line'>
</span><span class='line'>   <span class="n">printf</span><span class="p">(</span><span class="s">&quot;[AFTER] buffer_two is at %p and contains </span><span class="se">\&#39;</span><span class="s">%s</span><span class="se">\&#39;\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">buffer_two</span><span class="p">,</span> <span class="n">buffer_two</span><span class="p">);</span>
</span><span class='line'>   <span class="n">printf</span><span class="p">(</span><span class="s">&quot;[AFTER] buffer_one is at %p and contains </span><span class="se">\&#39;</span><span class="s">%s</span><span class="se">\&#39;\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">buffer_one</span><span class="p">,</span> <span class="n">buffer_one</span><span class="p">);</span>
</span><span class='line'>   <span class="n">printf</span><span class="p">(</span><span class="s">&quot;[AFTER] value is at %p and is %d (0x%08x)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">overflow</span><span class="err">@</span><span class="n">hacking</span><span class="o">:~/</span><span class="n">booksrc</span> <span class="err">$</span> <span class="n">gcc</span> <span class="o">-</span><span class="n">o</span> <span class="n">overflow_example</span> <span class="n">overflow_example</span><span class="p">.</span><span class="n">c</span>
</span><span class='line'><span class="n">overflow</span><span class="err">@</span><span class="n">hacking</span><span class="o">:~/</span><span class="n">booksrc</span> <span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">overflow_example</span> <span class="mi">1234567890</span>
</span><span class='line'><span class="p">[</span><span class="n">BEFORE</span><span class="p">]</span> <span class="n">buffer_two</span> <span class="n">is</span> <span class="n">at</span> <span class="mh">0xbffff7f0</span> <span class="n">and</span> <span class="n">contains</span> <span class="err">&#39;</span><span class="n">two</span><span class="err">&#39;</span>
</span><span class='line'><span class="p">[</span><span class="n">BEFORE</span><span class="p">]</span> <span class="n">buffer_one</span> <span class="n">is</span> <span class="n">at</span> <span class="mh">0xbffff7f8</span> <span class="n">and</span> <span class="n">contains</span> <span class="err">&#39;</span><span class="n">one</span><span class="err">&#39;</span>
</span><span class='line'><span class="p">[</span><span class="n">BEFORE</span><span class="p">]</span> <span class="n">value</span> <span class="n">is</span> <span class="n">at</span> <span class="mh">0xbffff804</span> <span class="n">and</span> <span class="n">is</span> <span class="mi">5</span> <span class="p">(</span><span class="mh">0x00000005</span><span class="p">)</span>
</span><span class='line'><span class="p">[</span><span class="n">STRCPY</span><span class="p">]</span> <span class="n">copying</span> <span class="mi">10</span> <span class="n">bytes</span> <span class="n">into</span> <span class="n">buffer_two</span>
</span><span class='line'><span class="p">[</span><span class="n">AFTER</span><span class="p">]</span> <span class="n">buffer_two</span> <span class="n">is</span> <span class="n">at</span> <span class="mh">0xbffff7f0</span> <span class="n">and</span> <span class="n">contains</span> <span class="err">&#39;</span><span class="mi">1234567890</span><span class="err">&#39;</span>
</span><span class='line'><span class="p">[</span><span class="n">AFTER</span><span class="p">]</span> <span class="n">buffer_one</span> <span class="n">is</span> <span class="n">at</span> <span class="mh">0xbffff7f8</span> <span class="n">and</span> <span class="n">contains</span> <span class="err">&#39;</span><span class="mi">90</span><span class="err">&#39;</span>
</span><span class='line'><span class="p">[</span><span class="n">AFTER</span><span class="p">]</span> <span class="n">value</span> <span class="n">is</span> <span class="n">at</span> <span class="mh">0xbffff804</span> <span class="n">and</span> <span class="n">is</span> <span class="mi">5</span> <span class="p">(</span><span class="mh">0x00000005</span><span class="p">)</span>
</span><span class='line'><span class="n">overflow</span><span class="err">@</span><span class="n">hacking</span><span class="o">:~/</span><span class="n">booksrc</span> <span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>Probably you will try to check this code on your computer (macos in my case), but <a href="https://en.wikipedia.org/wiki/Buffer_overflow_protection">buffer overflow protection</a> was included in release GCC 4.1 and you have to use <strong>-fno-stack-protector</strong> to compile your code. (hmm, i&#8217;m still getting error Program received signal SIGABRT, Aborted. which kills the proccess, couple clicks with google told me to recompile gcc. Seems now it&#8217;s not easy to write bogus code =)). In this case I have virtual machine with 32-bit pretty old Ubuntu.</p>

<figure class='code'><figcaption><span>t.c</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &lt;stdio.h&gt; </span>
</span><span class='line'><span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;string.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">Q</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kt">char</span> <span class="n">c</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
</span><span class='line'>    <span class="n">strcpy</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span> <span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">Q</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The return address in a stack frame can be located by undestanding how the stack frame is created. This process begins in the main() function even before the function call.</p>

<p>Couple things you have to know about the stack. The stack is used to pass prcedure arguments, <strong>to store return information</strong>, to save registers for later restoration and for local storage. The portion of the stack allocated for a single procedure call is called a <strong>stack frame</strong>. $EBP register serving as the <strong>frame pointer</strong> and register $ESP serving as the <strong>stack pointer</strong>.</p>

<p>The main idea is when main() calls Q() the <strong>return</strong> address within main() where the program should resume execution when it returns from Q. If somebody can overwrite return address it can jump or/and execute other code.</p>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/4/4f/Stack_Overflow_2.png" alt="" /></p>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/9/93/Stack_Overflow_3.png" alt="" /></p>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Stack_Overflow_4.png" alt="" /></p>

<p>More details you can find in the paper above. If you are interesting in roots of the problem and how actually stack/heap works, I highly recommend to read the book <a href="http://www.amazon.com/Computer-Systems-A-Programmers-Perspective/dp/013034074X">Computer System: A Programmer&#8217;s Perspective by Bryant and O&#8217;Hallaron</a>.</p>

<p>The first step is always the hardest. Will see how long I hold out.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-11-20T23:17:00-08:00" pubdate data-updated="true">Nov 20<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/computer-security/'>computer security</a>, <a class='category' href='/blog/categories/great-papers/'>great papers</a>, <a class='category' href='/blog/categories/research/'>research</a>


</div>
	
</div></article>


    <article class="post">
	<h1 class="title"><a href="/blog/2012/11/17/computer-and-network-security-specializations/">Computer and Network Security Specializations</a></h1>
	<div class="entry-content">
		<ol type="a">
<li><p>Each of the following: CS 140, 144, 155, 244, 255</p></li>
<li><p>CS 140: Operating Systems</p></li>
<li>CS 144: Introduction to Computer Networking (*)</li>
<li>CS 155: Computer and Network Security (*)</li>
<li>CS 244: Advanced Topics in Networking</li>
<li><p>CS 255: Introduction to Cryptography</p></li>
<li><p>At least three of the following: CS 142, 240, 241, 244B, 244C, 259, 261, 340, 344, 355, 365</p></li>
<li><p>CS 142: Web Applications (*)</p></li>
<li>CS 240: Advanced Topics in Operating Systems</li>
<li>CS 241: Secure Web Programming</li>
<li>CS 244B: Distributed Systems</li>
<li>CS 244C: Distributed System Projects</li>
<li>CS 259: Security Modeling and Analysis</li>
<li>CS 261: Optimization and Algorithmic Paradigms</li>
<li>CS 340: Networked Systems for Virtual Worlds</li>
<li>CS 344: Building an Internet Router</li>
<li>CS 355: Topics in Cryptography</li>
<li><p>CS 365: Randomized Algorithms</p></li>
<li><p>Sufficient additional units selected from (b) and the following: CS 240E, 244E, 245, 294S<em>, 295, 341, 344B, 345, 347, 361A, 393</em>, 395<em>, 399</em>, EE 384A, 384B, 384C, 384M, 384S, 384X, 384Y</p></li>
<li><p>CS 240E: Embedded Wireless Systems</p></li>
<li>CS 244E: Wireless Networking</li>
<li>CS 245: Database System Principles</li>
<li>CS 294S: Paradigm Shifts in Mobile and Social Computing Systems</li>
<li>CS 295: Software Engineering</li>
<li>CS 341: Project in Mining Massive Data Sets</li>
<li>CS 344B: Advanced Topics in Distributed Systems</li>
<li>CS 345: Advanced Topics in Database Systems</li>
<li>CS 347: Parallel and Distributed Data Management</li>
<li>CS 361A: Advanced Algorithms</li>
<li>CS 393: Computer Laboratory</li>
<li>CS 395: Independent Database Project</li>
<li>CS 399: Independent Project</li>
<li>EE 384A: Internet Routing Protocols and Standards</li>
<li>EE 384B: Mutimedia Communication over the Internet</li>
<li>EE 384C: Wireless Local Area Networks</li>
<li>EE 384M: Network Algorithms</li>
<li>EE 384S: Network Architectures and Performance Engineering</li>
<li>EE 384X: Packet Switch Architectures I</li>
<li>EE 384Y: Packet Switch Architectures II</li>
</ol>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-11-17T10:41:00-08:00" pubdate data-updated="true">Nov 17<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/computer-security/'>computer security</a>, <a class='category' href='/blog/categories/stanford/'>stanford</a>, <a class='category' href='/blog/categories/study/'>study</a>


</div>
	
</div></article>

<nav id="pagenavi">
    
        <a href="/blog/page/5/" class="prev">Prev</a>
    
    
        <a href="/blog/page/7/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2013

    khakimov

</footer>
	<script src="/javascripts/slash.js"></script>
<script type="text/javascript">
var _hcp = _hcp || {};
_hcp.widget_id = 2313;
_hcp.widget = "Stream";
(function() { 
var hcc = document.createElement("script"); hcc.type = "text/javascript"; hcc.async = true;
hcc.src = ("https:" == document.location.protocol ? "https" : "http")+"://widget.hypercomments.com/apps/js/hc.js";
var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hcc, s.nextSibling); 
})();</script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->




	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-31552911-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>